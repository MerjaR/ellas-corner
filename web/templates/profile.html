<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ .Username }}'s Profile</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

    {{ template "navbar" . }}

    <main class="content-container">
        <h1 class="page-title">{{ .Username }}'s Profile</h1>

        <div class="profile-header">
            <img src="/static/profile_pictures/{{ .ProfilePicture }}" alt="Profile Picture" class="profile-picture">
            <div class="profile-info">
                <p><strong>Email:</strong> {{ .Email }}</p>

                <form action="/upload-profile-picture" method="POST" enctype="multipart/form-data" class="profile-upload-form">
                    <label for="profile_picture" class="upload-label">Change profile picture:</label>
                    <div class="upload-controls">
                        <input type="file" name="profile_picture" id="profile_picture" accept="image/*" class="upload-input">
                        <button type="submit" class="upload-button">Upload</button>
                    </div>
                </form>
            </div>
        </div>

        <section>
            <h2>Your Items</h2>
            {{ if .Posts }}
 {{ template "post" (dict "Posts" .Posts "isLoggedIn" true "ShowEditControls" true) }}
{{ else }}
  <p>You haven't posted anything yet.</p>
{{ end }}
        </section>

        <section class="comments-section">
            <h2>Your Comments</h2>
            {{ if .Comments }}
            {{ range .Comments }}
            <div class="comment">
                <p><strong>On Post:</strong> {{ .PostTitle }}</p>
                <p>{{ .Content }}</p>
                <p><strong>Commented on:</strong> {{ .FormattedCreatedAt }}</p>
                <form action="/delete-comment" method="POST" style="display:inline;">
  <input type="hidden" name="comment_id" value="{{ .ID }}">
  <button type="submit" class="delete-button" onclick="return confirm('Are you sure you want to delete this comment?')">Delete</button>
</form>
            </div>
            {{ end }}
            {{ else }}
            <p>You haven't commented on anything yet.</p>
            {{ end }}
        </section>

        <section>
            <h2>Items You Liked</h2>
            {{ if .LikedPosts }}
    {{ template "post" (dict "Posts" .LikedPosts "isLoggedIn" true) }}
  {{ else }}
    <p>You haven't liked any items yet.</p>
  {{ end }}
        </section>

        <section>
            <h2>Items You Found Unhelpful</h2>
            {{ if .DislikedPosts }}
    {{ template "post" (dict "Posts" .DislikedPosts "isLoggedIn" true) }}
  {{ else }}
    <p>Looks like you haven’t marked any items as unhelpful yet.</p>
  {{ end }}
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Ella’s Corner. All Rights Reserved.</p>
    </footer>
       <script>
  // Save scroll position before navigating away
  window.addEventListener("beforeunload", function () {
    localStorage.setItem("scrollY", window.scrollY);
  });

  // Restore scroll position on load
  window.addEventListener("load", function () {
    const scrollY = localStorage.getItem("scrollY");
    if (scrollY !== null) {
      window.scrollTo(0, parseInt(scrollY));
    }
  });
</script>
</body>
</html>
